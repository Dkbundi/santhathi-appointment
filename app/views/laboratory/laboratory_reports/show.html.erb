<div class='continer'>
  <center> <h3 class = 'head'> <%=@lab_test.name %> Test Report </h3></center> 
  <div class = 'hide-for-print'>
    <table><tr>
           <td  style="padding: 0 10px 0px 10px;"> <%= link_to_function("Print Report", "javascript:print()") %> </td>
           <td  style="padding: 0 10px 0px 10px;"> <%= link_to("Export Report to PDF", formatted_laboratory_prescribed_test_laboratory_report_url(:prescribed_test_id => '56', :id => '6',:format =>'pdf' )) %> </td>
         </tr>
    </table>
    <br />

    <table class="clinical-table">
       <tr> <th> Test Name : </th>
            <th> Patient Name :</th>
            <th> Patient Age :</th>
            <th> Patient Gender :</th>
            <th> Hospital No :</th>
            <th> PVR No :</th>
       </tr>
	   
       <tr>
          <td> <%=h @lab_test.name %> </td>
          <td> <%=h @patient.patient_name %> </td>
          <td> <%=h calculate_age(@patient.dob) %> </td>
          <td> <%=h @patient.gender %> </td>
          <td> <%=h @patient.reg_no%> </td>
          <td> <%=h @appointment.patient.id %> </td>
       </tr>
    </table><br/>
  </div>
  
  <div class ='only-for-print' >
    <table class="clinical-table">
       <tr> <th> <b> Name: </b> </th> <td> <%=h @patient.patient_name %> </td>
            <th> <b> Age: </b></th> <td> <%=h calculate_age(@patient.dob) %> </td>
            <th> <b> Hospital: </b> No </th> <td> <%=h @patient.reg_no%> </td>
            <th> <b> Date: </b></th>  <td> <%=h Time.now.strftime('%d/%m/%Y') %> </td>
       </tr>
	   
    </table>
  </div>

  <table class="report" style="cursor: move;">
  	<thead>
       <tr> 
	  <th> Parameter Name </th>
          <th> UOM </th>
          <th> Result </th>
          <th> Remarks </th>
          <th>Ideal Value</th>
          <th> Min Limit </th>
          <th>	Max Limit </th>
       </tr>
	 </thead>
	 <tbody id = "results">
       <% unless @specifications.blank? %>
         <% for spec in @specifications %>
           <%parameter = spec.parameter%>
           <% unless parameter.value_type == 'Header' %>
              <tr id = "spec_<%= "#{spec.id}" %>"><td><%= parameter.parameter_name %></td>
                <td><%= parameter.measurement_unit.name %></td>

                <td><%= @results[spec.id][0] unless @results[spec.id].blank?%></td>
                <td><%= @results[spec.id][1] unless @results[spec.id].blank? %></td>
                 <% test = find_parameter_specification(@lab_test.id, spec.parameter_id) %>
                <td> <%=h test.ideal_value %> </td>
                <td> <%=h test.min_value %></td>
                <td> <%=h test.max_value %> </td>
               </tr>
           <%else%>
              <tr class='header' id = "spec_<%= "#{spec.id}" %>"><td  colspan=7><b><%= parameter.parameter_name %></b></td> </tr>
           <%end%>
        <%end%>
       <%end%>
	  </tbody>
    </table>
	<%= sortable_element 'results',
     :url => { :action => 'sort_results' },
     :complete => visual_effect(:highlight, 'results'),
     :tag => 'tr'
     %>
	 <br/>
</div>
