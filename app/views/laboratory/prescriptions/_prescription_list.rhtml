<h3>Prescription List</h3>


<table class="listing">
  <tr>
<<<<<<< HEAD:app/views/laboratory/prescriptions/_prescription_list.rhtml
    <th> <%= remote_order_by_link({:prescription => { :appointment => { :patient => :reg_no }}} , :text => "Hospital No") %>   </th>
    <th><%= remote_order_by_link({:prescription =>  { :appointment => { :patient => :id }} } , :text => "PVR No") %>  </th>
    <th> <%= remote_order_by_link({:prescription => { :appointment => { :patient => :patient_name }}} , :text => "Patient Name") %></th>
    <th><%= remote_order_by_link( {:lab_test =>:name }  , :text => "Test Prescribed") %> </th>
    <th> Patient Type(IP/OP)</th>
    <th> Status </th>
    <th> Test Report </th>
    <th> Presc. Details </th>
   </tr>

  <% for test in @prescribed_tests %>
        <tr class="<%= cycle('odd', 'even') %>" >
          <% prescription = test.prescription %>
          <% patient = prescription.appointment.patient %>
          <td> <%=h patient.reg_no %>         </td>
          <td> <%=h patient.id %>         </td>
          <td> <%= patient.patient_name %>         </td>
	  <td> <%= test.lab_test.name %> </td>
          <td> OP </td>
	  <td> completed </td>
	  <td> <%= prescription.laboratory_reports.blank? ? (link_to "Create Report", new_laboratory_prescribed_test_laboratory_report_path(test)) : (link_to "View Report", laboratory_prescribed_test_laboratory_report_path(:prescribed_test_id => test, :id => test.lab_test.laboratory_report)) %>
	  </td>
          <td> </td>
	</tr>
=======
     <th> <%= remote_order_by_link(:p_date , :text => "Prescribed Date") %>   </th>
     <th> Prescription Time</th>
     <th> Quantity </th>
     <th> Urgency </th>
     <th> Follow Up </th>
     <th> Department </th>
    <th> <%= remote_order_by_link( { :appointment => { :patient => :reg_no }}  , :text => "Hospital No") %>   </th>
    <th> <%= remote_order_by_link(  { :appointment => { :patient => :id }}   , :text => "PVR No") %>  </th>
     <th> <%= remote_order_by_link( { :appointment => { :patient => :patient_name }} , :text => "Patient Name") %> </th>
     <th> Doctor </th>
  </tr>   
    
<% unless  @prescreptions.blank? %>
  <% for prescription in @prescreptions %>
     <tr class="<%= cycle('odd', 'even') %>" >
       <td> <%=h prescription.p_date %> </td>
       <td> <%=h Time.parse(prescription.p_time.to_s).strftime('%H:%M') %></td>
       <td> <%=h prescription.quantity %></td>
       <td> <%=h prescription.urgency %></td>
       <td> <%=h prescription.follow_up %> </td>
       <td> <%=h Department.find(prescription.department_id).dept_name unless prescription.department_id.blank? %></td>
       
       <td> <%=h prescription.appointment.patient.reg_no %>  </td>
        <td> <%=h prescription.appointment.patient.id %>  </td>
       <td> <%=h prescription.appointment.patient.patient_name %></td>
       <td> <%=h DoctorProfile.by_doctor_id(prescription.appointment.doctor_id).first.name %></td>
       <td> </td>
           
	   </tr>
>>>>>>> e689f7fba8e182acb53899c72b1be87d769253a8:app/views/laboratory/prescriptions/_prescription_list.rhtml
  <% end %>

  <tr class="table-footer">
   <td colspan = 1><%= remote_per_page_select %></td>
        <td colspan = 1>
          <% form_tag(laboratory_prescriptions_url, :method => :get, :id => "goto") do %>
              <% fields_for @search do |f|%>
                <%= f.text_field :page , :class => 'textbox-tiny' %></td>
              <%end%>
          <%end%>
        </td>
         <td colspan = 9> <% unless @prescriptions.blank? %>
                             <div class="pagination">
                                <%= remote_page_links %>
                             </div>
                           <% end %>
         </td>
  </tr>
<%end%>  
</table>
<%= image_tag("spinner.gif",
              :align => "absmiddle",
              :border => 0,
              :id => "spinner1",
              :style =>"display: none;" ) %>

<%= observe_form("goto", :frequency => 1,
                 :before => "Element.show('spinner')",
                 :success => "Element.hide('spinner')",
                 :url => laboratory_prescriptions_url, :method => :get) %>
 </table>
