<%= image_tag("spinner.gif",
              :align => "absmiddle",
              :border => 0,
              :id => "spinner",
              :style =>"display: none;" ) %>

<table class="listing">

  <tr>
    <th></th>
    <th>No</th>
    <th>Date</th>
    <th>Time</th>
    <th>Doctor</th>
    <th>Patient</th>
    <th>Reason</th>
    <th>Status</th>
    <th>Reg. No</th>
    <!--<th>Details</th>-->
    <th NOWRAP = NOWRAP>View | Edit | Cancel</th>
  </tr>
<% for appointment in @appointments %>
  <tr valign="top" class="<%= cycle('odd', 'even') %>">
  	<td class='radio-column'><%=radio_button_tag ('appointment', appointment.id, checked = false, options = {:onclick => "$('main_form').appointment_id.value=#{appointment.id};"})%></td>
    <td><%=h appointment.id %></td>
    <td><%=h appointment.appointment_date %></td>
    <td><%=h Time.parse(appointment.appointment_time.to_s).strftime('%H:%M').to_s %></td>
    <td><%=h appointment.doctor.name%></td>
    <td><%= link_to appointment.patient.patient_name, patient_url(appointment.patient), :rel=> "facebox" %></td>
    <td><%=h appointment.reason.name %></td>

    <td><%= appointment.state == 'new_appointment'? 'New (' + link_to('Confirm', confirm_appointment_url(appointment, :page => params[:page]), :method => :get, :confirm => 'This action will mark this appointment as patient visited. are you sure?') + ')' :appointment.state %></td>

    <td><%= appointment.patient.reg_no.blank? ? link_to('Register', edit_patient_url(appointment.patient)) : appointment.patient.reg_no%> </td>

    <!--<td><%= link_to 'Appointments', patient_patient_appointments_url(appointment.patient), :rel=> "facebox" %></td> -->

    <td NOWRAP = NOWRAP>&nbsp;&nbsp; <%= link_to image_tag('show.png', {:title => 'Show', :border => 0}), appointment_url(appointment), :rel=> "facebox" %> &nbsp;&nbsp;| &nbsp;&nbsp; <%= link_to image_tag('edit.png', {:title => 'Edit', :border => 0}), edit_appointment_path(appointment) %> &nbsp;&nbsp;|&nbsp;&nbsp; <%= link_to image_tag('delete.png', {:title => 'cancel appointment', :border => 0}), appointment_path(appointment), :confirm => 'Are you sure?', :method => :delete %></td>

  </tr>
<% end %>
  <tr class="table-footer">
  	     <td colspan = 5><%= link_to "<span>New appointment</span>", new_appointment_path, :class=> "button" %></td>
         <td colspan = 5> <% if @appointments.size > 1 %>
                             <div class="pagination">
                                <%= remote_page_links %>
                             </div>
                           <% end %>
         </td>
  </tr>
</table>
